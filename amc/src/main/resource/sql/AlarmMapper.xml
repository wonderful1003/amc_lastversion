<?xml version="1.0" encoding="UTF-8" ?>

<!DOCTYPE mapper
		PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
		"http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="AlarmMapper">
 	
 	<resultMap id="alarmSelectMap" type="com.amc.service.domain.Alarm">
  			<result property="alarmNo" column="alarm_no" jdbcType="NUMERIC"/>
  			<result property="screenContentNo" column="screencontent_no" jdbcType="NUMERIC"/>
  			<result property="userId" column="user_id" jdbcType="VARCHAR"/>
  			<result property="alarmRegDate" column="alarm_regdate" jdbcType="DATE"/>
  			<result property="alarmSeatNo" column="alarmseat_no" jdbcType="VARCHAR"/>
  			<result property="alarmFlag" column="alarm_flag" jdbcType="CHAR"/>
	</resultMap>
	
	<insert 	id="addAlarm"	parameterType="alarm" >
	 	INSERT
		INTO alarm	( alarm_no, screencontent_no, user_id, alarm_regdate,
					<if test="alarmSeatNo != null"> 
					alarmseat_no, 
					</if>
					alarm_flag)
		VALUES	 	( seq_alarm_no.nextval, #{screenContentNo}, #{userId}, SYSDATE, 
					<if test="alarmSeatNo != null">	
					#{alarmSeatNo},
					</if> 
					#{alarmFlag} )
	</insert>
	 
	<delete id="deleteOpenAlarm" parameterType="alarm">
		DELETE
		FROM alarm
		WHERE screencontent_no = #{screenContentNo} AND user_id = #{userId}
	</delete>
	 
	<select id="checkOpenAlarm"	parameterType="alarm" resultType="string">
	 	SELECT count(*) FROM alarm WHERE screencontent_no = #{screenContentNo} AND user_id = #{userId}
	</select>

</mapper>